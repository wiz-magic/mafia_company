<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>íšŒì‚¬ì—ì„œ ì‚´ì•„ë‚¨ê¸°</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-38FCHPTQ6W"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-38FCHPTQ6W');
    </script>
    <style>
        body {
            touch-action: manipulation;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            overscroll-behavior: none;
            background-color: #f0f9ff;
            color: #334155;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .choice-btn {
            transition: transform 0.2s, background-color 0.2s;
        }

        .choice-btn:active {
            transform: scale(0.95);
        }

        .fade-in {
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .popup {
            animation: popup 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popup {
            from {
                transform: scale(0.5);
                opacity: 0;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .bounce {
            animation: bounce 0.5s;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            10%,
            30%,
            50%,
            70%,
            90% {
                transform: translateX(-5px);
            }

            20%,
            40%,
            60%,
            80% {
                transform: translateX(5px);
            }
        }

        .progress-bar {
            transition: width 0.3s ease;
        }

        .option-overlay {
            transition: opacity 0.3s ease;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
            }
        }
    </style>
</head>

<body>
    <div id="game-container" class="min-h-screen flex flex-col items-center justify-center p-4">
        <!-- ì‹œì‘ í™”ë©´ -->
        <div id="start-screen" class="flex flex-col items-center justify-center text-center max-w-md w-full popup">
            <h1 class="text-4xl font-bold mb-4 text-blue-600">íšŒì‚¬ì—ì„œ ì‚´ì•„ë‚¨ê¸°</h1>
            <p class="mb-6 text-gray-600">ë§¤í„´, ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ë™ë£Œë“¤ ì†ì—ì„œ ëˆ„êµ¬ë¥¼ ë¯¿ê³ ,<br />ì–¸ì œ ë°°ì‹ í• ì§€ íŒë‹¨í•˜ì„¸ìš”</p>
            <button id="start-btn"
                class="bg-blue-700 hover:bg-blue-800 text-white font-bold py-3 px-8 rounded-lg shadow-lg text-lg transition duration-200 transform hover:scale-105">
                ê²Œì„ ì‹œì‘
            </button>
            <p class="mt-4 text-xs text-gray-500">ì´ 10í„´, ìµœê³ ì˜ ìƒì¡´ ì ìˆ˜ë¥¼ ê¸°ë¡í•´ë³´ì„¸ìš”</p>
        </div>

        <!-- ê²Œì„ í™”ë©´ -->
        <div id="game-screen" class="max-w-md w-full hidden">
            <!-- ìƒë‹¨ ì •ë³´ -->
            <div class="flex justify-between items-center mb-2 px-2">
                <div class="text-gray-600 text-sm"><span id="current-turn">1</span>/10 í„´</div>
                <div class="text-lg font-bold text-gray-800">ì ìˆ˜: <span id="score" class="text-blue-600">0</span></div>
            </div>
            <!-- ì§„í–‰ ë°” -->
            <div class="w-full bg-blue-100 rounded-full h-2 mb-4">
                <div id="progress-bar" class="bg-blue-600 h-2 rounded-full progress-bar" style="width: 10%"></div>
            </div>
            <!-- ì‹œë‚˜ë¦¬ì˜¤ ì¹´ë“œ -->
            <div class="bg-white rounded-lg p-4 mb-4 shadow-lg popup border border-blue-200">
                <h3 id="scenario-title" class="text-xl font-bold mb-2 text-blue-600">ì‹œë‚˜ë¦¬ì˜¤ ì œëª©</h3>
                <p id="scenario-text" class="text-gray-700 mb-3">ì‹œë‚˜ë¦¬ì˜¤ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
                <p class="text-sm text-gray-500">ë‹¹ì‹ ì˜ ì„ íƒì€?</p>
            </div>
            <!-- ì„ íƒì§€ ë²„íŠ¼ -->
            <div class="grid grid-cols-2 gap-3 mb-4">
                <button class="choice-btn bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg shadow"
                    data-choice="cooperate">
                    <div class="font-bold mb-1">í˜‘ë ¥</div>
                    <div class="text-xs option-desc">ì„¤ëª…</div>
                </button>
                <button class="choice-btn bg-red-600 hover:bg-red-700 text-white py-3 px-4 rounded-lg shadow"
                    data-choice="betray">
                    <div class="font-bold mb-1">ë°°ì‹ </div>
                    <div class="text-xs option-desc">ì„¤ëª…</div>
                </button>
                <button class="choice-btn bg-yellow-600 hover:bg-yellow-700 text-white py-3 px-4 rounded-lg shadow"
                    data-choice="defend">
                    <div class="font-bold mb-1">íšŒí”¼</div>
                    <div class="text-xs option-desc">ì„¤ëª…</div>
                </button>
                <button class="choice-btn bg-purple-600 hover:bg-purple-700 text-white py-3 px-4 rounded-lg shadow"
                    data-choice="observe">
                    <div class="font-bold mb-1">ëˆˆì¹˜</div>
                    <div class="text-xs option-desc">ì„¤ëª…</div>
                </button>
            </div>
            <!-- ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->
            <div id="result-area" class="hidden bg-white rounded-lg p-4 mb-4 shadow-lg popup border border-blue-200">
                <div class="flex justify-between mb-3">
                    <div>
                        <div class="text-sm text-gray-500">ë‹¹ì‹ ì˜ ì„ íƒ</div>
                        <div id="player-choice" class="font-bold text-lg text-gray-800"></div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-gray-500">ìƒëŒ€ì˜ ì„ íƒ</div>
                        <div id="opponent-choice" class="font-bold text-lg text-gray-800"></div>
                    </div>
                </div>
                <div class="text-center mb-3">
                    <div id="result-effect" class="text-2xl font-bold mb-1"></div>
                    <div id="result-explanation" class="text-sm text-gray-600"></div>
                </div>
                <button id="next-turn-btn"
                    class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 rounded-lg shadow">
                    ë‹¤ìŒ í„´
                </button>
            </div>
            <!-- íŒíŠ¸ ì•„ì´ì½˜ -->
            <div class="flex justify-end">
                <button id="hint-btn" class="text-blue-500 hover:text-blue-700">
                    <i class="fas fa-lightbulb mr-1"></i> íŒíŠ¸
                </button>
            </div>
        </div>

        <!-- ê²Œì„ ì¢…ë£Œ í™”ë©´ -->
        <div id="end-screen" class="max-w-md w-full hidden text-center popup">
            <h2 class="text-3xl font-bold mb-3 text-blue-600">ê²Œì„ ì¢…ë£Œ!</h2>
            <div class="bg-white rounded-lg p-5 mb-4 shadow-lg border border-blue-200">
                <p class="text-xl mb-2 text-gray-800">ìƒì¡´ ì ìˆ˜</p>
                <p id="final-score" class="text-4xl font-bold text-blue-600 mb-3">0</p>
                <div class="mb-4">
                    <p class="text-gray-600 mb-2">í†µê³„</p>
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <div class="bg-blue-50 p-2 rounded border border-blue-100 text-gray-700">í˜‘ë ¥: <span
                                id="stat-cooperate">0</span>íšŒ</div>
                        <div class="bg-blue-50 p-2 rounded border border-blue-100 text-gray-700">ë°°ì‹ : <span
                                id="stat-betray">0</span>íšŒ</div>
                        <div class="bg-blue-50 p-2 rounded border border-blue-100 text-gray-700">íšŒí”¼: <span
                                id="stat-defend">0</span>íšŒ</div>
                        <div class="bg-blue-50 p-2 rounded border border-blue-100 text-gray-700">ëˆˆì¹˜: <span
                                id="stat-observe">0</span>íšŒ</div>
                    </div>
                </div>
                <p id="game-comment" class="text-gray-700 mb-4">ê²Œì„ í‰ê°€ ë©”ì‹œì§€</p>
                <button id="restart-btn"
                    class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg text-lg transition duration-200 transform hover:scale-105">
                    ë‹¤ì‹œ ë„ì „í•˜ê¸°
                </button>
            </div>
        </div>

        <!-- íŒíŠ¸ ëª¨ë‹¬ -->
        <div id="hint-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 hidden">
            <div class="bg-white rounded-lg p-5 m-4 max-w-md w-full popup border border-blue-200">
                <h3 class="text-xl font-bold mb-3 text-blue-600">ê²Œì„ íŒíŠ¸</h3>
                <p class="text-gray-700 mb-3">ìƒí™© ì† ë™ë£Œì˜ <span class="text-blue-600">ë¯¸ë¬˜í•œ íŒíŠ¸</span>ê°€ ìˆ¨ê²¨ì ¸ ìˆìŠµë‹ˆë‹¤.</p>
                <p class="text-gray-700 mb-3">ê° ì„ íƒì´ ì£¼ëŠ” ì ìˆ˜:</p>
                <ul class="text-sm text-gray-600 mb-4 space-y-1">
                    <li>â€¢ ë‘˜ ë‹¤ í˜‘ë ¥: +7ì </li>
                    <li>â€¢ ë°°ì‹  vs í˜‘ë ¥: +8ì </li>
                    <li>â€¢ í˜‘ë ¥ vs ë°°ì‹ : -3ì </li>
                    <li>â€¢ ë‘˜ ë‹¤ ë°°ì‹ : -4ì </li>
                    <li>â€¢ íšŒí”¼ vs ë°°ì‹ : +2ì </li>
                    <li>â€¢ ëˆˆì¹˜: ë‹¤ìŒ í„´ ì ìˆ˜ Ã—1.5ë°° ë²„í”„</li>
                    <li>â€¢ ë ˆì–´ í¬ë¦¬í‹°ì»¬: 10% í™•ë¥ ë¡œ +15ì !</li>
                </ul>
                <button id="close-hint-btn"
                    class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 rounded-lg shadow">
                    í™•ì¸
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const initialScenarios = [
                {
                    title: "íšŒì˜ ë¶ˆì°¸ ê³µëª¨",
                    text: "ë‘˜ ë‹¤ ì¤‘ìš”í•œ íšŒì˜ë¥¼ 'ë³‘ì› ì˜ˆì•½'ì´ë€ í•‘ê³„ë¡œ ë¹ ì¡Œë‹¤. ìƒì‚¬ê°€ 'ê°™ì€ ë³‘ì›?'ì´ë¼ë©° ì›ƒëŠ”ë‹¤.",
                    hint: "defend",
                    options: {
                        cooperate: "ìƒì‚¬ì—ê²Œ ì†”ì§íˆ íšŒì˜ ë¹ ì¡Œë‹¤ê³  ìë°±í•˜ê³  ê°™ì´ ì‚¬ê³¼í•˜ì",
                        betray: "ë™ë£Œê°€ ì£¼ë„í–ˆë‹¤ê³  ëª°ì•„ì„¸ìš°ê³  ë¹ ì ¸ë‚˜ê°€ì",
                        defend: "ë³‘ì› ì˜ˆì•½ì´ì—ˆë‹¤ê³  ëê¹Œì§€ ìš°ê²¨ì„œ ë¹ ì ¸ë‚˜ê°€ì",
                        observe: "ìƒì‚¬ì˜ ë°˜ì‘ì„ ë” ì‚´í•€ ë’¤ ê²°ì •í•˜ì"
                    }
                },
                {
                    title: "ëŒ€í‘œë‹˜ ì¼€ì´í¬",
                    text: "ëŒ€í‘œë‹˜ ìƒì¼ ì¼€ì´í¬ë¥¼ ë°˜ë§Œ ë¨¹ì—ˆëŠ”ë°, ê·¸ ë™ë£Œë„ ê°™ì€ í–‰ë™ì„ í•˜ë‹¤ ë“¤ì¼°ë‹¤.",
                    hint: "observe",
                    options: {
                        cooperate: "ì¼€ì´í¬ ìƒˆë¡œ ì‚¬ì„œ ë‘˜ì´ í•¨ê»˜ ì‚¬ê³¼í•˜ì",
                        betray: "ëŒ€ë¶€ë¶„ì„ ë™ë£Œê°€ ë¨¹ì—ˆë‹¤ê³  ì±…ì„ ì „ê°€í•˜ì",
                        defend: "ë‚œ ëª°ëë‹¤ê³  ë‘˜ëŸ¬ëŒ€ë©° ë¹ ì ¸ë‚˜ê°€ì",
                        observe: "ë™ë£Œì˜ í‘œì •ê³¼ ìƒí™©ì„ ë³´ê³  ë‹¤ìŒ í–‰ë™ì„ ì •í•˜ì"
                    }
                },
                {
                    title: "ë©”ì¼ ëª°ë˜ ì‚­ì œ",
                    text: "ì‹¤ìˆ˜ë¡œ ë³´ë‚¸ ê¸°ë°€ ë©”ì¼ì„ ëª°ë˜ ì§€ìš´ ê±´ ë‚˜, ê³µì¡°í•´ì¤€ ê±´ ê·¸ ì‚¬ëŒ. ìƒì‚¬ê°€ 'ë©”ì¼ ë¡œê·¸ ë³´ì'ê³  í•œë‹¤.",
                    hint: "betray",
                    options: {
                        cooperate: "ë‘˜ì´ì„œ ì‚¬ì‹¤ëŒ€ë¡œ ë°íˆê³  ë³µêµ¬ ë°©ì•ˆì„ ì œì‹œí•˜ì",
                        betray: "ì‚­ì œëŠ” ë™ë£Œê°€ í–ˆë‹¤ê³  ë°€ì–´ë¶™ì´ì",
                        defend: "ì‹œìŠ¤í…œ ì˜¤ë¥˜ë¼ê³  ë‘˜ëŸ¬ëŒ€ë©° ì‹œê°„ ë²Œì",
                        observe: "ìƒì‚¬ ëˆˆì¹˜ ë³´ë©° íƒ€ì´ë°ì„ ì¬ì"
                    }
                },
                {
                    title: "ì´ìƒí•œ ë°œí‘œìë£Œ",
                    text: "í”„ë ˆì  í…Œì´ì…˜ì— ì—‰ëš±í•œ ì‚¬ì§„ì´ ì„ì˜€ë‹¤. ë§Œë“  ê±´ ë‚˜ì§€ë§Œ, ê²€ìˆ˜ëŠ” ê·¸ê°€ í–ˆë‹¤. ë‘˜ ë‹¤ ì…ì„ ê¾¹ ë‹¤ë¬¼ê³  ìˆë‹¤.",
                    hint: "observe",
                    options: {
                        cooperate: "ì‹¤ìˆ˜ ì¸ì •í•˜ê³  ìë£Œë¥¼ ì¦‰ì‹œ ìˆ˜ì •í•˜ì",
                        betray: "ê²€ìˆ˜ ëª» í•œ ë™ë£Œ íƒ“ìœ¼ë¡œ ëª°ì•„ê°€ì",
                        defend: "ìë™ ì‚½ì… ì˜¤ë¥˜ë¼ë©° ë„˜ê¸°ì",
                        observe: "ìƒì‚¬ì˜ ë°˜ì‘ì„ ë³´ê³  ì±…ì„ ì†Œì¬ë¥¼ ì •í•˜ì"
                    }
                },
                {
                    title: "íšŒì‹ë¹„ ê³„ì‚° ëˆ„ë½",
                    text: "ì˜ìˆ˜ì¦ì„ ì¼ë¶€ëŸ¬ ëˆ„ë½í•´ ì œì¶œí–ˆë‹¤. ì ˆë°˜ì€ ê·¸ ì‚¬ëŒ ëª«ì´ì—ˆë‹¤. ê°ì‚¬íŒ€ì´ 'ì™œ ê³„ì‚°ì´ ì•ˆ ë§ëƒ'ê³  ë¬»ëŠ”ë‹¤.",
                    hint: "betray",
                    options: {
                        cooperate: "ë‘˜ì´ ì˜ìˆ˜ì¦ ì¬ì œì¶œí•˜ê³  ê¸ˆì•¡ ë§ì¶”ì",
                        betray: "ì˜ìˆ˜ì¦ ì±™ê¸´ ê±´ ë™ë£Œë¼ê³  ëª°ì•„ì„¸ìš°ì",
                        defend: "ì‹œìŠ¤í…œ ì˜¤ë¥˜ë¼ë©° ì‹œê°„ ë²Œì",
                        observe: "ê°ì‚¬íŒ€ ë¶„ìœ„ê¸° ë³´ë©° ì „ëµ ì •í•˜ì"
                    }
                },
                {
                    title: "íšŒì˜ì‹¤ ì˜ˆì•½ ê¼¼ìˆ˜",
                    text: "íšŒì˜ì‹¤ì—ì„œ íŒ€ì›ì´ë‘ ë†€ì•˜ë‹¤. ê°ì‚¬íŒ€ì´ ê°œë³„ ë©´ë‹´ì„ í•œë‹¤. ë“¤í‚¨ ê±´ ë§ê³  ëˆ„ê°€ ì´ë¥¼ì§€ ëª¨ë¥¸ë‹¤.",
                    hint: "betray",
                    options: {
                        cooperate: "ì¥ë‚œ ì¸ì •í•˜ê³  ì‚¬ê³¼í•´ ë²Œì  ìµœì†Œí™”í•˜ì",
                        betray: "íšŒì˜ì‹¤ ì‚¬ìš© ì•„ì´ë””ì–´ëŠ” ë™ë£Œë¼ë©° ë– ë„˜ê¸°ì",
                        defend: "ì˜ˆì•½ ì‹œìŠ¤í…œ ì°©ì˜¤ë¼ê³  ë‘˜ëŸ¬ëŒ€ì",
                        observe: "ê°ì‚¬íŒ€ ì§ˆë¬¸ì„ ë³´ë©° ì…ì¥ ì •í•˜ì"
                    }
                },
                {
                    title: "ëŒ€ë¦¬ ì¶œê·¼",
                    text: "ì„œë¡œ ì¶œí‡´ê·¼ ì¹´ë“œë¥¼ ì°ì–´ì£¼ê¸°ë¡œ í–ˆë‹¤. ì¸ì‚¬íŒ€ì´ ì œë³´ìë¥¼ ìš©ì„œí•´ì¤€ë‹¤ë©° ë‚´ ëˆˆì¹˜ë¥¼ ë³¸ë‹¤.",
                    hint: "cooperate",
                    options: {
                        cooperate: "ë‘˜ì´ í•œêº¼ë²ˆì— ìë°±í•˜ê³  ê°ê²½ì„ ë…¸ë¦¬ì",
                        betray: "ëŒ€ë¦¬ ì¶œê·¼ì€ ë™ë£Œ ë¶€íƒì´ì—ˆë‹¤ë©° ë°œëºŒí•˜ì",
                        defend: "ì¹´ë“œ ì˜¤ë¥˜ë¼ ì£¼ì¥í•˜ë©° ë¹ ì ¸ë‚˜ê°€ì",
                        observe: "ì¸ì‚¬íŒ€ ë¶„ìœ„ê¸°ë¥¼ ì‚´í”¼ë©° íƒ€ì´ë° ì¬ì"
                    }
                },
                {
                    title: "ê°œì¸ ì¼ì • ê³µìœ  ë¯¸ìŠ¤",
                    text: "ê·¸ì™€ ê³µìœ í•œ ì—°ì°¨ ê³„íšì´ ë‹¤ë¥¸ íŒ€ì›ì—ê²Œ í¼ì¡Œë‹¤. ìƒì‚¬ê°€ ì •ìƒ‰í•˜ê³  ë¬»ëŠ”ë‹¤.",
                    hint: "observe",
                    options: {
                        cooperate: "ë‘˜ì´ ìœ ì¶œ ì‚¬ì‹¤ ì¸ì •í•˜ê³  ì‚¬ê³¼í•˜ì",
                        betray: "ì—°ì°¨ ê³„íš í˜ë¦° ê±´ ë™ë£Œë¼ê³  ì§€ëª©í•˜ì",
                        defend: "ìº˜ë¦°ë” ë²„ê·¸ë¼ë©° ë„˜ê¸°ì",
                        observe: "ìƒì‚¬ ëˆˆì¹˜ ë³´ë©° ì±…ì„ ì†Œì¬ ê°€ëŠ í•˜ì"
                    }
                },
                {
                    title: "í´ë¼ìš°ë“œ íŒŒì¼ ì‚­ì œ",
                    text: "ì¤‘ìš”í•œ íšŒì˜ë¡ì´ ì‚¬ë¼ì¡Œë‹¤. ë‚´ê°€ ì§€ìš´ ê±´ ë§ì§€ë§Œ, íœ´ì§€í†µ ë¹„ìš´ ê±´ ê·¸ ì‚¬ëŒì´ë‹¤.",
                    hint: "cooperate",
                    options: {
                        cooperate: "ë‘˜ì´ ì‹¤ìˆ˜ ì¸ì •í•˜ê³  ë³µêµ¬ ì‹œë„í•˜ì",
                        betray: "íœ´ì§€í†µ ë¹„ìš´ ê±´ ë™ë£Œë¼ë©° ëª°ì•„ì„¸ìš°ì",
                        defend: "ì‹œìŠ¤í…œ ì˜¤ë¥˜ë¼ë©° ì‹œê°„ ë²Œì",
                        observe: "ë©”ì‹œì§€ ë¶„ìœ„ê¸° ë³´ë©° íƒœì„¸ ì „í™˜í•˜ì"
                    }
                },
                {
                    title: "ì—…ë¬´ìš© ì±„íŒ… ìš•ì„¤",
                    text: "ì—…ë¬´ìš© ì±„íŒ…ë°©ì— ì‹¤ìˆ˜ë¡œ ìƒì‚¬ ìš•ì„¤ì„ ì˜¬ë ¸ë‹¤. ìƒì‚¬ëŠ” ë™ë£Œê°€ ë‹¤ ë§í–ˆë‹¤ê³  í•œë‹¤.",
                    hint: "defend",
                    options: {
                        cooperate: "ë‘˜ì´ ì‚¬ê³¼í•˜ê³  ì˜¤í•´ í’€ì",
                        betray: "ìš•ì€ ë™ë£Œê°€ ë¨¼ì € ì¼ë‹¤ë©° ì±…ì„ íšŒí”¼í•˜ì",
                        defend: "ìë™ì™„ì„± ì‹¤ìˆ˜ë¼ë©° ì–¼ë²„ë¬´ë¦¬ì",
                        observe: "ìƒì‚¬ í™”ë‚œ ì •ë„ë¥¼ ë³´ê³  ëŒ€ì‘í•˜ì"
                    }
                },
                {
                    title: "ê·¼íƒœ ê¸°ë¡ ì¡°ì‘",
                    text: "ë‘˜ ë‹¤ ì¡°í‡´í–ˆì§€ë§Œ ê¸°ë¡ì€ ì •ìƒ í‡´ê·¼ìœ¼ë¡œ ì¡°ì‘í–ˆë‹¤. ì¸ì‚¬íŒ€ì´ ë¶ˆì¼ì¹˜ë¥¼ ë°œê²¬í–ˆë‹¤.",
                    hint: "observe",
                    options: {
                        cooperate: "ê¸°ë¡ ìˆ˜ì •í•˜ê³  ë²Œì  ê°ìˆ˜í•˜ì",
                        betray: "ì¡°í‡´ ê¸°ë¡ ì…ë ¥í•œ ê±´ ë™ë£Œë¼ë©° ëª°ì•„ì„¸ìš°ì",
                        defend: "ì‹œìŠ¤í…œ ì‹œê°„ ì˜¤ë¥˜ë¼ ì£¼ì¥í•˜ì",
                        observe: "ì¸ì‚¬íŒ€ ì¡°ì‚¬ ì†ë„ ë³´ë©° ëŒ€ì‘ì±… ì •í•˜ì"
                    }
                },
                {
                    title: "í”„ë¡œì íŠ¸ ì‹¤íŒ¨ ì€í",
                    text: "í”„ë¡œì íŠ¸ ì‹¤íŒ¨ë¥¼ ìˆ¨ê¸°ê³  ì„±ê³µí•œ ê²ƒì²˜ëŸ¼ ë³´ê³ í–ˆë‹¤. ê°ì ê°ì‚¬íŒ€ ë©´ë‹´ì„ ë°›ëŠ”ë‹¤.",
                    hint: "defend",
                    options: {
                        cooperate: "ì‹¤íŒ¨ ì‚¬ì‹¤ ë°íˆê³  í•´ê²°ì±… ì œì‹œí•˜ì",
                        betray: "ë³´ê³ ì„œ ì‘ì„±í•œ ë™ë£Œ ì±…ì„ìœ¼ë¡œ ëŒë¦¬ì",
                        defend: "ë°ì´í„° ë¶€ì¡±ìœ¼ë¡œ íŒë‹¨ ì´ë¥´ë‹¤ë©° ë¯¸ë£¨ì",
                        observe: "ê°ì‚¬íŒ€ ë¶„ìœ„ê¸°ë¥¼ ì‚´í”¼ì"
                    }
                },
                {
                    title: "ì‚¬ë‚´ ê³µëª¨ì „ í‘œì ˆ",
                    text: "ì¸í„°ë„· ìë£Œë¥¼ í‘œì ˆí•´ ì œì¶œí–ˆë‹¤. ì‹¬ì‚¬ìœ„ì›ì´ 'ì–´ë””ì„œ ë³¸ ê²ƒ ê°™ë‹¤'ê³  í•œë‹¤.",
                    hint: "defend",
                    options: {
                        cooperate: "í‘œì ˆ ì¸ì •í•˜ê³  ì‘í’ˆ ì·¨ì†Œí•˜ì",
                        betray: "ìë£Œ ê°€ì ¸ì˜¨ ê±´ ë™ë£Œë¼ê³  ëª°ì•„ì„¸ìš°ì",
                        defend: "ë ˆí¼ëŸ°ìŠ¤ ì°¸ê³ ë¼ë©° ìš°ê²¨ë³´ì",
                        observe: "ì‹¬ì‚¬ìœ„ì› ë°˜ì‘ì„ ë³´ë©° ë°©í–¥ ì¡ì"
                    }
                },
                {
                    title: "ì„±ê³¼ ë°œí‘œ ëŒ€ë¦¬",
                    text: "ë‚´ê°€ ì‘ì„±í•œ ì„±ê³¼ìë£Œë¥¼ ë™ë£Œê°€ ëŒ€ì‹  ë°œí‘œí–ˆëŠ”ë° í‹€ë ¸ë‹¤. ìƒì‚¬ê°€ ì™œ ì§ì ‘ ì•ˆ í–ˆëƒê³  ë¬»ëŠ”ë‹¤.",
                    hint: "defend",
                    options: {
                        cooperate: "ì˜ëª» ì¸ì •í•˜ê³  ë³´ì™„ ì•½ì†í•˜ì",
                        betray: "ë°œí‘œ í‹€ë¦° ê±´ ë™ë£Œ ì±…ì„ì´ë¼ ì„ ê¸‹ê¸°",
                        defend: "í˜„ì¥ ì˜¤ë¥˜ë¼ ì£¼ì¥í•˜ë©° ë„˜ê¸°ì",
                        observe: "ìƒì‚¬ ê¸°ë¶„ ì‚´í”¼ë©° ìˆ˜ìŠµì±… ëª¨ìƒ‰"
                    }
                },
                {
                    title: "í˜‘ë ¥ì‚¬ ë¹„ë°€ ìœ ì¶œ",
                    text: "íšŒì˜ ë„ì¤‘ í˜‘ë ¥ì‚¬ ê¸°ë°€ì„ í˜ë ¸ë‹¤. ê·¸ê°€ ì›ƒìœ¼ë©° ë§ì¥êµ¬ì³¤ë‹¤. í˜‘ë ¥ì‚¬ í•­ì˜ê°€ ë“¤ì–´ì™”ë‹¤.",
                    hint: "betray",
                    options: {
                        cooperate: "ì‚¬ê³¼í•˜ê³  ë³´ì•ˆ ëŒ€ì±… ì œì‹œí•˜ì",
                        betray: "ë¹„ë°€ ë§í•œ ê±´ ë™ë£Œë¼ë©° ì„ ê¸‹ê¸°",
                        defend: "íšŒì˜ ì˜¤í•´ë¼ë©° ë…¼ì  íë¦¬ì",
                        observe: "í˜‘ë ¥ì‚¬ ë¶„ë…¸ ìˆ˜ìœ„ë¥¼ ë³´ë©° íŒë‹¨í•˜ì"
                    }
                },
                {
                    title: "ì‚¬ë‚´ ê²Œì‹œíŒ ì¥ë‚œ",
                    text: "ìµëª… ê²Œì‹œíŒì— ì¥ë‚œ ê¸€ì„ ì˜¬ë ¸ë‹¤. ì¸ì‚¬íŒ€ì´ ì¡°ì‚¬ ì¤‘ì´ë‹¤.",
                    hint: "observe",
                    options: {
                        cooperate: "ì¥ë‚œ ì¸ì •í•˜ê³  ì‚­ì œ ìš”ì²­í•˜ì",
                        betray: "ì•„ì´ë””ì–´ ì¤€ ë™ë£Œ íƒ“í•˜ë©° ì±…ì„ íšŒí”¼",
                        defend: "ìµëª…ì„± ë¯¿ê³  ëª¨ë¥¸ë‹¤ ì£¼ì¥",
                        observe: "ì¸ì‚¬íŒ€ ì§ˆë¬¸ ë°©í–¥ íŒŒì•…í•˜ë©° ê²°ì •í•˜ì"
                    }
                },
                {
                    title: "ìœ ë ¹ íšŒì˜ ì°¸ì„",
                    text: "ì°¸ì„ë„ ì•ˆ í•œ íšŒì˜ì— ì¶œì„ì²´í¬ë§Œ í–ˆë‹¤. íŒ€ì¥ì´ ì°¸ì„ìì—ê²Œ ì§ì ‘ ë¬¼ì–´ë³´ê¸° ì‹œì‘í–ˆë‹¤.",
                    hint: "cooperate",
                    options: {
                        cooperate: "ìë°±í•˜ê³  ë²Œì  ìµœì†Œí™” ì„¤ë“í•˜ì",
                        betray: "ì¶œì„ ì²´í¬ëŠ” ë™ë£Œê°€ ë¶€íƒí–ˆë‹¤ë©° ëª°ì•„ê°€ê¸°",
                        defend: "ì‹œìŠ¤í…œ ìë™ ì²´í¬ë¼ ì£¼ì¥",
                        observe: "íŒ€ì¥ ë°˜ì‘ì„ ë³´ë©° ì „ëµ ìˆ˜ë¦½"
                    }
                },
                {
                    title: "ë¬´ë‹¨ ì™¸ê·¼",
                    text: "íšŒì‚¬ì™€ ë¬´ê´€í•œ ê³³ìœ¼ë¡œ ì™¸ê·¼ ê°”ë‹¤. ìƒì‚¬ê°€ ìœ„ì¹˜ ê¸°ë¡ ì œì¶œì„ ìš”êµ¬í•œë‹¤.",
                    hint: "observe",
                    options: {
                        cooperate: "ì™¸ê·¼ ì‚¬ì‹¤ ì¸ì •í•˜ê³  ì •ì • ë³´ê³ í•˜ì",
                        betray: "ì™¸ê·¼ ëª©ì ì€ ë™ë£Œê°€ ì •í–ˆë‹¤ë©° ë°€ê¸°",
                        defend: "GPS ì˜¤ë¥˜ë¼ ì£¼ì¥í•˜ë©° ì‹œê°„ ë²Œì",
                        observe: "ìƒì‚¬ íƒœë„ë¥¼ ì‚´í”¼ë©° ì…ì¥ ì¡°ìœ¨"
                    }
                },
                {
                    title: "ì±„ìš© ì¶”ì²œ ì¡°ì‘",
                    text: "ì§€ì¸ì˜ ì´ë ¥ì„œë¥¼ ìˆ˜ì •í•´ì¤¬ë‹¤. ì¶”ì²œì¸ìœ¼ë¡œ ë‚  ì˜¬ë ¸ê³  ì±„ìš©íŒ€ì´ ì‚¬ì‹¤ ì—¬ë¶€ë¥¼ í™•ì¸ ì¤‘ì´ë‹¤.",
                    hint: "defend",
                    options: {
                        cooperate: "ì‚¬ì‹¤ ì¸ì •í•˜ê³  ì±„ìš©íŒ€ì— ì‚¬ê³¼í•˜ì",
                        betray: "ì´ë ¥ì„œ ìˆ˜ì •ì€ ë™ë£Œê°€ í–ˆë‹¤ë©° ê°•ì¡°",
                        defend: "ë‹¨ìˆœ ì˜¤íƒ€ ìˆ˜ì •ì´ì—ˆë‹¤ê³  ìš°ê¸°ê¸°",
                        observe: "ì±„ìš©íŒ€ ì§ˆë¬¸ ê²½í–¥ ì‚´í”¼ë©° ì¤€ë¹„í•˜ì"
                    }
                },
                {
                    title: "ì§ì› í‰ê°€ ìœ„ì¡°",
                    text: "ì„œë¡œ ì ìˆ˜ë¥¼ ë†’ì—¬ì¤¬ë‹¤. ì‹œìŠ¤í…œì´ ë¹„ì •ìƒ íŒ¨í„´ì„ ì˜ì‹¬í•œë‹¤.",
                    hint: "cooperate",
                    options: {
                        cooperate: "í‰ê°€ ì¡°ì‘ ì¸ì •í•˜ê³  ì ìˆ˜ ì¬ì…ë ¥í•˜ì",
                        betray: "ë™ë£Œê°€ ë¨¼ì € ì¡°ì‘í–ˆë‹¤ê³  ë°€ì–´ë„£ê¸°",
                        defend: "ì‹œìŠ¤í…œ ì˜¤ë¥˜ë¼ ì£¼ì¥í•˜ë©° ì‹œê°„ ë²Œê¸°",
                        observe: "ê²€í† íŒ€ ë°˜ì‘ì„ ë³´ë©° ë‹¤ìŒ ìˆ˜"
                    }
                },
                {
                    title: "ìƒì‚¬ ì„±ëŒ€ëª¨ì‚¬ ìœ ì¶œ",
                    text: "ì ì‹¬ì‹œê°„ ì„±ëŒ€ëª¨ì‚¬ë¥¼ ì°ì€ ë™ë£Œê°€ ì‹¤ìˆ˜ë¡œ íŒ€ ì±„íŒ…ë°©ì— ì˜¬ë ¸ë‹¤. ì´ë¯¸ ëª¨ë‘ ë´¤ë‹¤.",
                    hint: "betray",
                    options: {
                        cooperate: "ë‘˜ì´ ì‚¬ê³¼ ì˜ìƒ ì°ì–´ ì˜¬ë¦¬ì",
                        betray: "ì˜ìƒ ì˜¬ë¦° ê±´ ë™ë£Œë¼ë©° ê°•ë³€í•˜ì",
                        defend: "íŒŒì¼ ì „ì†¡ ì˜¤ë¥˜ë¼ë©° ì‹¤ìˆ˜ ê°•ì¡°",
                        observe: "íŒ€ ë°˜ì‘ì„ ì‚´í”¼ë©° ì‚¬ê³¼ íƒ€ì´ë° ì¡°ì •"
                    }
                },
                {
                    title: "ë³´ê³ ì„œ ë¬´ì„ìŠ¹ì°¨",
                    text: "ë³´ê³ ì„œì— ë‚´ ì´ë¦„ë§Œ ë„£ì—ˆì§€ë§Œ, ì‹¤ì œ ì‘ì—…ì€ ë°˜ì„ ê·¸ê°€ ë„ì™€ì¤¬ë‹¤. ìƒì‚¬ê°€ ê¸°ì—¬ë„ë¥¼ ë”°ì§„ë‹¤.",
                    hint: "defend",
                    options: {
                        cooperate: "ê¸°ì—¬ë„ ì†”ì§íˆ ë°íˆê³  ê³µë™ ì±…ì„ ì œì•ˆ",
                        betray: "ë‚´ê°€ 90% í–ˆë‹¤ë©° ë™ë£Œ ê³µí—Œ ê¹ê¸°",
                        defend: "ë¶„ì—…í•œ ê²ƒë¿ì´ë¼ë©° ë¬¸ì œ ì—†ë‹¤ê³  ì£¼ì¥",
                        observe: "ìƒì‚¬ ë°˜ì‘ ë³´ë©° ì…ì¥ ì„ íƒí•˜ì"
                    }
                },
                {
                    title: "ë³µì‚¬ê¸° íŒŒì†",
                    text: "ë³µì‚¬ê¸°ê°€ ê³ ì¥ ë‚¬ë‹¤. ì–´ì œ ë‘˜ì´ ì‚¬ì ì¸ ë¬¸ì„œë¥¼ ì¸ì‡„í–ˆì—ˆë‹¤.",
                    hint: "observe",
                    options: {
                        cooperate: "ì‚¬ìš© ì‚¬ì‹¤ ì¸ì •í•˜ê³  ìˆ˜ë¦¬ ì‹ ì²­í•˜ì",
                        betray: "ë™ë£Œê°€ ì´ìƒí•œ ë¬¸ì„œ ì¸ì‡„í–ˆë‹¤ê³  ëª°ì•„ì„¸ìš°ì",
                        defend: "ì›ë˜ ê³ ì¥ ë‚˜ ìˆë˜ ë“¯ ì£¼ì¥í•˜ì",
                        observe: "ì„¤ë¹„íŒ€ ì¡°ì‚¬ ê²°ê³¼ë¥¼ ë³´ê³  ê²°ì •í•˜ì"
                    }
                },
                {
                    title: "ì•¼ê·¼ ì‹ë¹„ ì´ì¤‘ ì²­êµ¬",
                    text: "ì•¼ê·¼ ì‹ëŒ€ë¥¼ ë‘˜ ë‹¤ ì´ì¤‘ìœ¼ë¡œ ì²­êµ¬í–ˆë‹¤. íšŒê³„íŒ€ì´ í™•ì¸ ìš”ì²­ì„ í–ˆë‹¤.",
                    hint: "betray",
                    options: {
                        cooperate: "ê¸ˆì•¡ í™˜ê¸‰í•˜ê³  ì‹¤ìˆ˜ ì¸ì •í•˜ì",
                        betray: "ì´ì¤‘ ì²­êµ¬ëŠ” ë™ë£Œê°€ í–ˆë‹¤ë©° ì„ ê¸‹ê¸°",
                        defend: "íšŒê³„ ì‹œìŠ¤í…œ ë²„ê·¸ë¼ ì£¼ì¥í•˜ì",
                        observe: "íšŒê³„íŒ€ íƒœë„ë¥¼ ë³´ë©° ì „ëµ ì§œì"
                    }
                },
                {
                    title: "ì™¸ë¶€ ê°•ì˜ ìœ ì¶œ",
                    text: "ë‚´ê°€ ìˆ˜ê°• ì¤‘ì¸ ìœ ë£Œ ê°•ì˜ë¥¼ ê³µìœ í–ˆê³ , ë™ë£Œê°€ íŒ€ ë©”ì‹ ì €ì— ë§í¬ë¥¼ í¼ëœ¨ë ¸ë‹¤. ë²•ë¬´íŒ€ì´ ì¶”ì  ì¤‘ì´ë‹¤.",
                    hint: "betray",
                    options: {
                        cooperate: "ì €ì‘ê¶Œ ì¹¨í•´ ì¸ì •í•˜ê³  ë§í¬ ì‚­ì œí•˜ì",
                        betray: "ë§í¬ ë¿Œë¦° ê±´ ë™ë£Œë¼ë©° ëª°ì•„ê°€ê¸°",
                        defend: "ì •ì‹ í™ë³´ ì°¨ì›ì´ì—ˆë‹¤ê³  ë³€ëª…í•˜ì",
                        observe: "ë²•ë¬´íŒ€ ì¡°ì‚¬ ìˆ˜ìœ„ë¥¼ ë³´ë©° ëŒ€ì‘í•˜ì"
                    }
                }

            ];

            const gameState = {
                currentTurn: 1,
                maxTurns: 10,
                score: 0,
                lastObserved: false,
                defendStreak: 0,
                choiceStats: { cooperate: 0, betray: 0, defend: 0, observe: 0 },
                opponentChoices: [],
                playerChoices: [],
                remainingScenarios: []
            };

            const els = {
                start: document.getElementById('start-screen'),
                game: document.getElementById('game-screen'),
                end: document.getElementById('end-screen'),
                turn: document.getElementById('current-turn'),
                score: document.getElementById('score'),
                bar: document.getElementById('progress-bar'),
                title: document.getElementById('scenario-title'),
                text: document.getElementById('scenario-text'),
                choiceBtns: document.querySelectorAll('.choice-btn'),
                descs: document.querySelectorAll('.option-desc'),
                resultArea: document.getElementById('result-area'),
                playerChoice: document.getElementById('player-choice'),
                opponentChoice: document.getElementById('opponent-choice'),
                resultEffect: document.getElementById('result-effect'),
                resultExplanation: document.getElementById('result-explanation'),
                nextBtn: document.getElementById('next-turn-btn'),
                finalScore: document.getElementById('final-score'),
                restartBtn: document.getElementById('restart-btn'),
                hintBtn: document.getElementById('hint-btn'),
                closeHintBtn: document.getElementById('close-hint-btn'),
                hintModal: document.getElementById('hint-modal'),
                stats: {
                    coop: document.getElementById('stat-cooperate'),
                    betray: document.getElementById('stat-betray'),
                    defend: document.getElementById('stat-defend'),
                    observe: document.getElementById('stat-observe')
                },
                comment: document.getElementById('game-comment')
            };

            els.start.querySelector('#start-btn').addEventListener('click', startGame);
            els.nextBtn.addEventListener('click', nextTurn);
            els.restartBtn.addEventListener('click', startGame);
            els.hintBtn.addEventListener('click', () => els.hintModal.classList.remove('hidden'));
            els.closeHintBtn.addEventListener('click', () => els.hintModal.classList.add('hidden'));
            els.choiceBtns.forEach(btn => btn.addEventListener('click', () => makeChoice(btn.dataset.choice)));

            function startGame() {
                // GA ì´ë²¤íŠ¸ - ê²Œì„ ì‹œì‘
                gtag('event', 'game_start', {
                    'event_category': 'gameplay',
                    'event_label': 'new_game'
                });

                els.start.classList.add('hidden');
                els.end.classList.add('hidden');
                els.game.classList.remove('hidden');
                resetGame();
                nextTurn();
            }

            function resetGame() {
                gameState.currentTurn = 0;
                gameState.score = 0;
                gameState.lastObserved = false;
                gameState.defendStreak = 0;
                Object.keys(gameState.choiceStats).forEach(k => gameState.choiceStats[k] = 0);
                gameState.opponentChoices = [];
                gameState.playerChoices = [];
                // ì‹œë‚˜ë¦¬ì˜¤ ë³µì œ
                gameState.remainingScenarios = initialScenarios.map(s => ({ ...s }));
            }

            function loadScenario() {
                const idx = Math.floor(Math.random() * gameState.remainingScenarios.length);
                const sc = gameState.remainingScenarios.splice(idx, 1)[0];
                gameState.currentScenario = sc;
                els.title.textContent = sc.title;
                els.text.textContent = sc.text;

                // GA ì´ë²¤íŠ¸ - ìƒˆ ì‹œë‚˜ë¦¬ì˜¤ ë¡œë“œ
                gtag('event', 'scenario_load', {
                    'event_category': 'gameplay',
                    'event_label': sc.title,
                    'turn_number': gameState.currentTurn
                });

                // ë²„íŠ¼ë³„ ì„¤ëª…ì„ optionsì—ì„œ ê°€ì ¸ì˜¤ë„ë¡ ë³€ê²½
                els.choiceBtns.forEach(btn => {
                    const key = btn.dataset.choice;
                    const descDiv = btn.querySelector('.option-desc');
                    descDiv.textContent = sc.options[key];
                    btn.disabled = false;
                });

                els.resultArea.classList.add('hidden');
            }




            function makeChoice(choice) {
                els.choiceBtns.forEach(b => b.disabled = true);
                const wasObs = gameState.lastObserved;
                const hint = gameState.currentScenario.hint;
                const opp = determineOpponentChoice(hint, wasObs);
                const res = calculateResult(choice, opp);

                if (wasObs) {
                    res.points = Math.round(res.points * 1.5);
                    res.effect = (res.points >= 0 ? '+' : '') + res.points + 'ì ! (ë²„í”„)';
                    res.explanation += ' ê´€ì°° ë²„í”„ ì ìš©.';
                }
                if (choice === 'defend' && opp === 'betray') gameState.defendStreak++;
                else gameState.defendStreak = 0;
                if (gameState.defendStreak >= 2) {
                    res.points += 3;
                    res.explanation += ' ì—°ì† íšŒí”¼ ë³´ë„ˆìŠ¤ +3ì !';
                }
                if (Math.random() < 0.1) {
                    res.points += 15;
                    res.effect = '+15ì !! (ë ˆì–´í¬ë¦¬í‹°ì»¬)';
                    res.explanation += ' ë ˆì–´ í¬ë¦¬í‹°ì»¬ ë°œìƒ!';
                }

                gameState.score += res.points;
                gameState.choiceStats[choice]++;
                gameState.playerChoices.push(choice);
                gameState.opponentChoices.push(opp);
                gameState.lastObserved = (choice === 'observe');

                // GA ì´ë²¤íŠ¸ - ì„ íƒ ì¶”ì 
                gtag('event', 'player_choice', {
                    'event_category': 'gameplay',
                    'event_label': choice,
                    'scenario_title': gameState.currentScenario.title,
                    'turn_number': gameState.currentTurn,
                    'opponent_choice': opp,
                    'points_earned': res.points,
                    'current_score': gameState.score
                });

                showResult(choice, opp, res);
                updateUI();
            }

            function determineOpponentChoice(hint, wasObs) {
                let base = 0.25;
                let bonus = wasObs ? 0.6 : 0.4;
                let ch = { cooperate: base, betray: base, defend: base, observe: base };
                ch[hint] += bonus;
                let total = Object.values(ch).reduce((a, b) => a + b, 0);
                for (let k in ch) ch[k] /= total;
                let rnd = Math.random(), cum = 0;
                for (let c of ['cooperate', 'betray', 'defend', 'observe']) {
                    cum += ch[c];
                    if (rnd <= cum) return c;
                }
                return 'cooperate';
            }

            function calculateResult(p, o) {
                let r = { points: 0, effect: '', explanation: '' };
                if (p === 'cooperate') {
                    if (o === 'cooperate') {
                        r.points = 7;
                        r.effect = '+7ì !';
                        r.explanation = 'ğŸ‘ ì™„ë²½í•œ íŒ€ì›Œí¬! ë‘˜ì´ì„œ ìœ„ê¸°ë¥¼ ê¸°íšŒë¡œ ë°”ê¿¨ë‹¤!';
                    } else if (o === 'betray') {
                        r.points = -3;
                        r.effect = '-3ì ';
                        r.explanation = 'ğŸ’” ì§„ì‹¬ì„ ì¤¬ë”ë‹ˆ, ë’¤í†µìˆ˜ê°€ ëŒì•„ì™”ë‹¤...';
                    } else if (o === 'defend') {
                        r.points = 2;
                        r.effect = '+2ì ';
                        r.explanation = 'ğŸ¤ ì†ì„ ë‚´ë°€ì—ˆì§€ë§Œ, ìƒëŒ€ëŠ” ìŠ¬ì© ë¹ ì¡Œë‹¤.';
                    } else {
                        r.points = 3;
                        r.effect = '+3ì ';
                        r.explanation = 'ğŸ” ë¯¿ì—ˆë”ë‹ˆ ì§€ì¼œë´¤ë‹¤? ì• ë§¤í•˜ì§€ë§Œ ì†í•´ëŠ” ì•„ë‹ˆë‹¤.';
                    }
                } else if (p === 'betray') {
                    if (o === 'cooperate') {
                        r.points = 8;
                        r.effect = '+8ì !';
                        r.explanation = 'ğŸ˜ˆ ì™€ë¥´ë¥´ ë¬´ë„ˆì¡Œë‹¤! ìƒëŒ€ì˜ ë¯¿ìŒì„ ì´ìš©í•´ ëŒ€ì´ë“!';
                    } else if (o === 'betray') {
                        r.points = -4;
                        r.effect = '-4ì ';
                        r.explanation = 'ğŸ”¥ ì¹˜ê³  ë°•ê³ ! ì„œë¡œ ì°”ëŸ¬ë´¤ì ì¿ë”ë¯¸ë§Œ ë‚¨ì•˜ë‹¤.';
                    } else if (o === 'defend') {
                        r.points = 0;
                        r.effect = 'Â±0ì ';
                        r.explanation = 'ğŸ¤·â€â™‚ï¸ ì°”ë €ì§€ë§Œ í—ˆê³µì„ ë² ì—ˆë‹¤. ë¬´ì˜ë¯¸í•œ ì‹œë„.';
                    } else {
                        r.points = 5;
                        r.effect = '+5ì ';
                        r.explanation = 'ğŸ•µï¸â€â™‚ï¸ ìƒëŒ€ê°€ ëˆˆì¹˜ ë³´ëŠ” ì‚¬ì´, ë’¤í†µìˆ˜ë¥¼ ì •í™•íˆ í›„ë ¤ì³¤ë‹¤!';
                    }
                } else if (p === 'defend') {
                    if (o === 'cooperate') {
                        r.points = 2;
                        r.effect = '+2ì ';
                        r.explanation = 'ğŸ˜¬ êµ³ì´ ìˆ¨ì—ˆëŠ”ë°, ì‚¬ì‹¤ ìˆ¨ì„ í•„ìš”ê°€ ì—†ì—ˆë„¤.';
                    } else if (o === 'betray') {
                        r.points = 2;
                        r.effect = '+2ì ';
                        r.explanation = 'ğŸ’¨ ìˆœë°œë ¥ ë°œë™! ë‚ ì¹´ë¡œìš´ ì¹¼ë‚ ì„ í”¼í•˜ê³  ë°˜ê²© ì¤€ë¹„ ì™„ë£Œ!';
                    } else if (o === 'defend') {
                        r.points = 1;
                        r.effect = '+1ì ';
                        r.explanation = 'ğŸ˜ ë‘˜ ë‹¤ ëª¸ ì‚¬ë ¸ë‹¤. ê¸´ì¥ë§Œ ê°€ë“í•œ ì¡°ìš©í•œ í•œ íŒ.';
                    } else {
                        r.points = 1;
                        r.effect = '+1ì ';
                        r.explanation = 'ğŸ‘€ ìˆ¨ê³  ì§€ì¼œë³´ê³ , ì„œë¡œ ê°„ë³´ëŠ” ìƒí™©. ë¯¸ë¬˜í•˜ê²Œ ì˜¬ë¼ê°„ ì ìˆ˜.';
                    }
                } else {
                    if (o === 'cooperate') {
                        r.points = 3;
                        r.effect = '+3ì ';
                        r.explanation = 'ğŸ“ˆ ì¡°ìš©íˆ ê´€ì°°í–ˆì§€ë§Œ, ê²°ê³¼ëŠ” í›ˆí›ˆí–ˆë‹¤. ì´ë“ ì±™ê¹€.';
                    } else if (o === 'betray') {
                        r.points = 0;
                        r.effect = 'Â±0ì ';
                        r.explanation = 'ğŸ¤” ëŠë‚Œì´ ì„í–ˆëŠ”ë°... ì˜ˆìƒì€ í–ˆì§€ë§Œ ì†ì— ì¥” ê±´ ì—†ë‹¤.';
                    } else if (o === 'defend') {
                        r.points = 1;
                        r.effect = '+1ì ';
                        r.explanation = 'ğŸ‘£ ëˆˆì¹˜ë§Œ ë³´ë‹¤ê°€ íšŒí”¼í•œ ìƒëŒ€ë¥¼ ë”°ë¼ê°”ë‹¤. í° ì¼ì€ ì—†ì—ˆë‹¤.';
                    } else {
                        r.points = 2;
                        r.effect = '+2ì ';
                        r.explanation = 'ğŸ”® ì„œë¡œ ëˆˆì¹˜ë§Œ ë³´ë‹¤ê°€ ì •ë³´ë§Œ ì‚´ì§ ì£¼ê³ ë°›ì€ ëŠë‚Œ.';
                    }
                }
                return r;
            }


            function showResult(p, o, r) {
                els.playerChoice.textContent = getLabel(p);
                els.opponentChoice.textContent = getLabel(o);
                els.resultEffect.textContent = r.effect;
                els.resultExplanation.textContent = r.explanation;
                els.resultArea.classList.remove('hidden');
                els.resultArea.classList.add('popup');
                if (r.points > 0) { els.resultEffect.classList.add('bounce'); els.resultEffect.style.color = '#4ade80'; }
                else if (r.points < 0) { els.resultEffect.classList.add('shake'); els.resultEffect.style.color = '#f87171'; }
                setTimeout(() => els.resultEffect.classList.remove('bounce', 'shake'), 500);
            }

            function nextTurn() {
                if (els.resultArea && !els.resultArea.classList.contains('hidden')) els.resultArea.classList.add('hidden');
                if (++gameState.currentTurn > gameState.maxTurns) return endGame();

                // GA ì´ë²¤íŠ¸ - ë‹¤ìŒ í„´ ì§„í–‰
                gtag('event', 'next_turn', {
                    'event_category': 'gameplay',
                    'event_label': 'progress',
                    'turn_number': gameState.currentTurn,
                    'current_score': gameState.score,
                    'completion_rate': (gameState.currentTurn / gameState.maxTurns * 100).toFixed(0) + '%'
                });

                updateUI();
                loadScenario();
                els.game.classList.add('fade-in');
                setTimeout(() => els.game.classList.remove('fade-in'), 500);
            }

            function endGame() {
                els.game.classList.add('hidden');
                els.end.classList.remove('hidden');
                els.finalScore.textContent = gameState.score;
                els.stats.coop.textContent = gameState.choiceStats.cooperate;
                els.stats.betray.textContent = gameState.choiceStats.betray;
                els.stats.defend.textContent = gameState.choiceStats.defend;
                els.stats.observe.textContent = gameState.choiceStats.observe;
                const c = gameState.score;
                els.comment.textContent =
                    c >= 60 ? 'ğŸ† ì‹ ê³¼ í•¨ê»˜, ë‹¹ì‹ ì€ ì‚¬ë‚´ì •ì¹˜ì˜ ì‹ !' :
                        c >= 50 ? 'ğŸ’¼ ë…¸ë ¨í•œ ë¹„ì¦ˆë‹ˆìŠ¤ë§¨! ë‹¹ì‹ ì˜ íŒë‹¨ì€ ì˜ˆë¦¬í–ˆë‹¤' :
                            c >= 40 ? 'ğŸ‘¶ ìœ ë§í•œ ì‹ ì…ì‚¬ì›! ì•ìœ¼ë¡œ ë” ë‚˜ì•„ì§ˆ ìˆ˜ ìˆì–´ìš”' :
                                c >= 30 ? 'ğŸ¥ ì‚¬íšŒ ì´ˆë…„ë³‘... ê·¸ë˜ë„ ê°€ëŠ¥ì„±ì€ ë³´ì—¬ìš”' :
                                    'â˜ ï¸ íšŒì‚¬ìƒí™œ, ë‹¤ì‹œ ìƒê°í•´ë´ì•¼ í•  ìˆ˜ë„...';

                // GA ì´ë²¤íŠ¸ - ê²Œì„ ì¢…ë£Œ
                gtag('event', 'game_end', {
                    'event_category': 'gameplay',
                    'event_label': 'completion',
                    'final_score': gameState.score,
                    'cooperate_count': gameState.choiceStats.cooperate,
                    'betray_count': gameState.choiceStats.betray,
                    'defend_count': gameState.choiceStats.defend,
                    'observe_count': gameState.choiceStats.observe
                });
            }

            function updateUI() {
                els.turn.textContent = gameState.currentTurn;
                els.score.textContent = gameState.score;
                els.bar.style.width = (gameState.currentTurn / gameState.maxTurns * 100) + '%';

                // GA ì´ë²¤íŠ¸ - ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                if (gameState.currentTurn > 0) {
                    gtag('event', 'progress_update', {
                        'event_category': 'gameplay',
                        'event_label': 'progress_percentage',
                        'progress_percentage': (gameState.currentTurn / gameState.maxTurns * 100).toFixed(0)
                    });
                }
            }

            function getLabel(k) {
                return k === 'cooperate' ? 'í˜‘ë ¥' : k === 'betray' ? 'ë°°ì‹ ' : k === 'defend' ? 'íšŒí”¼' : 'ëˆˆì¹˜';
            }

            loadScenario(); // ì´ˆê¸° ë¡œë“œ
        });
    </script>
</body>

</html>
